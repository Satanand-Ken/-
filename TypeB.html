<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KenB Typing Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #323437;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: #323437;
            border-radius: 20px;
            padding: 40px;
            max-width: 1000px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        h1 {
            text-align: center;
            color: #e2b714;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .timer-settings {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background: #2c2e31;
            border-radius: 10px;
        }

        .timer-settings label {
            font-size: 1.1em;
            color: #e2b714;
            font-weight: bold;
            margin-right: 10px;
        }

        .timer-settings select {
            padding: 8px 15px;
            font-size: 1em;
            border: 2px solid #e2b714;
            border-radius: 8px;
            background: #2c2e31;
            color: #e2b714;
            cursor: pointer;
            outline: none;
            transition: all 0.3s;
        }

        .timer-settings select:hover {
            border-color: #f4c430;
            box-shadow: 0 0 10px rgba(226, 183, 20, 0.3);
        }

        .timer-settings select:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .timer-settings select option {
            background: #2c2e31;
            color: #e2b714;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: #2c2e31;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: #e2b714;
            border: 1px solid #3d3f43;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
            color: #646669;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #e2b714;
        }

        .text-display {
            background: #2c2e31;
            padding: 30px;
            border-radius: 10px;
            font-size: 1.5em;
            line-height: 1.8;
            margin-bottom: 30px;
            min-height: 200px;
            max-height: 200px;
            overflow: hidden;
            letter-spacing: 0.5px;
            position: relative;
        }

        .text-display-scroll {
            transition: transform 0.3s ease;
        }

        .text-display span {
            color: #646669;
            transition: all 0.1s;
        }

        .text-display span.correct {
            color: #e2b714;
        }

        .text-display span.incorrect {
            color: #ca4754;
            background: rgba(202, 71, 84, 0.2);
        }

        .text-display span.current {
            border-left: 2px solid #e2b714;
            background: rgba(226, 183, 20, 0.1);
            padding: 0 2px;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .input-area {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #3d3f43;
            border-radius: 10px;
            outline: none;
            margin-bottom: 20px;
            margin-top: 40px;
            transition: all 0.3s;
            background: #2c2e31;
            color: #e2b714;
        }

        .input-area:focus {
            border-color: #e2b714;
            box-shadow: 0 0 15px rgba(226, 183, 20, 0.2);
        }

        .input-area:disabled {
            background: #2c2e31;
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-area::placeholder {
            color: #646669;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        button {
            padding: 12px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .start-btn {
            background: #e2b714;
            color: #323437;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(226, 183, 20, 0.4);
            background: #f4c430;
        }

        .start-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .reset-btn {
            background: #ca4754;
            color: white;
        }

        .reset-btn:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }

        .chart-container {
            margin-top: 30px;
            background: #2c2e31;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid #3d3f43;
        }

        .results {
            display: none;
            background: #2c2e31;
            padding: 30px;
            border-radius: 10px;
            color: #e2b714;
            text-align: center;
            margin-bottom: 20px;
            border: 2px solid #e2b714;
        }

        .results.show {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results h2 {
            margin-bottom: 20px;
            font-size: 2em;
            color: #e2b714;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .result-item {
            background: #3d3f43;
            padding: 15px;
            border-radius: 8px;
        }

        .result-item h3 {
            font-size: 0.9em;
            margin-bottom: 5px;
            opacity: 0.8;
            color: #646669;
        }

        .result-item p {
            font-size: 1.8em;
            font-weight: bold;
            color: #e2b714;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚å®Ô∏è Typing Speed Test</h1>
        
        <div class="timer-settings">
            <label for="timeSelect">Test Duration:</label>
            <select id="timeSelect">
                <option value="15">15 seconds</option>
                <option value="30">30 seconds</option>
                <option value="60" selected>60 seconds</option>
                <option value="90">90 seconds</option>
                <option value="120">120 seconds</option>
            </select>
        </div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">WPM</div>
                <div class="stat-value" id="wpm">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Accuracy</div>
                <div class="stat-value" id="accuracy">100%</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Time</div>
                <div class="stat-value" id="timer">60s</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Errors</div>
                <div class="stat-value" id="errors">0</div>
            </div>
        </div>

        <div class="results" id="results">
            <h2>üéâ Test Complete!</h2>
            <div class="results-grid">
                <div class="result-item">
                    <h3>Final WPM</h3>
                    <p id="finalWpm">0</p>
                </div>
                <div class="result-item">
                    <h3>Accuracy</h3>
                    <p id="finalAccuracy">0%</p>
                </div>
                <div class="result-item">
                    <h3>Characters Typed</h3>
                    <p id="finalChars">0</p>
                </div>
                <div class="result-item">
                    <h3>Total Errors</h3>
                    <p id="finalErrors">0</p>
                </div>
            </div>
        </div>

        <div class="text-display" id="textDisplay">
            <div class="text-display-scroll" id="textScroll"></div>
        </div>
        
        <input type="text" class="input-area" id="inputArea" placeholder="Click 'Start Test' to begin..." disabled>
        
        <div class="buttons">
            <button class="start-btn" id="startBtn">Start Test</button>
            <button class="reset-btn" id="resetBtn">Reset</button>
        </div>

        <div class="chart-container">
            <canvas id="wpmChart"></canvas>
        </div>
    </div>

    <script>
        const texts = [
            "The quick brown fox jumps over the lazy dog. Programming requires patience and practice. Data analysis helps make informed decisions. Every keystroke brings you closer to mastery. Success comes from dedication and continuous improvement.",
            "Learning to type faster improves productivity significantly. Practice makes perfect in all endeavors. Consistency is the key to developing any skill. Focus and determination lead to success. Hard work always yields positive results.",
            "Technology evolves rapidly in the modern world. Continuous learning keeps skills relevant and sharp. Dedication and hard work always pay off eventually. Excellence requires persistent effort and commitment. Innovation drives progress forward.",
            "Typing speed tests help measure progress over time. Regular practice sessions yield the best results. Setting goals provides direction and motivation. Improvement comes from consistent daily practice. Achievement requires patience and perseverance.",
            "Every expert was once a beginner who never gave up. Mistakes are valuable learning opportunities in disguise. Challenging yourself leads to personal growth and development. Persistence overcomes resistance in all situations. Success is built on countless small efforts.",
            "The journey of a thousand miles begins with a single step. Knowledge is power when applied with wisdom and care. Time invested in learning always brings valuable returns. Skills sharpen through deliberate practice and reflection. Excellence is a habit formed through repetition.",
            "Change is the only constant in our dynamic world. Adaptability ensures survival in challenging environments and situations. Creative thinking solves problems that seem impossible at first. Collaboration amplifies individual strengths and minimizes weaknesses. Together we achieve more than alone.",
            "Reading expands horizons and opens new perspectives daily. Writing clarifies thoughts and sharpens mental acuity significantly. Communication bridges gaps between different minds and cultures. Understanding others requires patience and genuine empathy always. Connection enriches life immeasurably.",
            "Dreams become reality through planning and consistent action. Vision without execution remains merely a fantasy forever. Small steps forward create momentum toward bigger goals. Discipline beats motivation when passion fades away temporarily. Results follow effort as surely as night follows day.",
            "Quality matters more than quantity in most endeavors. Deep work produces better outcomes than scattered efforts. Focus amplifies effectiveness and maximizes productivity gains. Distractions diminish potential and waste precious time daily. Attention is the currency of achievement and success.",
            "Curiosity fuels discovery and drives innovation forward constantly. Questions lead to answers that spark more questions. Exploration reveals possibilities hidden in plain sight always. Adventure awaits those brave enough to venture beyond comfort zones. Growth happens outside the boundaries of familiarity.",
            "Health is wealth that money cannot buy directly. Exercise strengthens body and mind in equal measure. Rest and recovery are essential for peak performance. Balance prevents burnout and sustains long-term productivity. Wellness requires daily commitment to healthy habits.",
            "Gratitude transforms ordinary days into extraordinary experiences and moments. Appreciation deepens relationships and strengthens social bonds significantly. Kindness costs nothing but enriches everyone it touches. Generosity creates abundance that multiplies through giving freely. Love is the greatest force in the universe.",
            "Data tells stories that numbers alone cannot convey clearly. Analysis reveals patterns invisible to casual observation always. Insights emerge from careful examination of complex information. Visualization makes abstract concepts tangible and understandable. Intelligence grows through interpretation and critical thinking.",
            "Teaching others reinforces and deepens personal understanding greatly. Sharing knowledge multiplies its value for entire communities. Mentorship creates ripples that extend across generations continuously. Guidance helps others avoid unnecessary struggles and mistakes. Legacy lives through the lives we touch and inspire.",
            "Challenges test character and reveal hidden strengths within. Adversity builds resilience that prosperity never develops fully. Failure provides feedback essential for eventual success always. Setbacks are setups for magnificent comebacks eventually. Obstacles are opportunities for growth in clever disguise.",
            "Efficiency maximizes output while minimizing wasted resources completely. Systems create consistency that individual effort cannot sustain. Automation handles repetitive tasks freeing humans for creativity. Optimization finds the best path toward desired outcomes. Improvement is an endless journey without final destination.",
            "Listening is more important than speaking in most conversations. Understanding precedes being understood in effective communication always. Empathy connects people across all differences and divisions. Respect earns trust that commands cannot ever compel. Relationships are built through consistent caring actions daily.",
            "Planning prevents poor performance in nearly every situation. Preparation builds confidence that eliminates unnecessary anxiety completely. Strategy guides tactics toward achieving larger objectives successfully. Goals give direction and purpose to daily activities. Structure enables freedom within defined boundaries safely.",
            "Creativity flourishes when constraints challenge conventional thinking patterns. Innovation emerges from combining existing ideas in novel ways. Imagination envisions futures that logic alone cannot reach. Originality requires courage to defy expectations and norms. Art expresses truths that words struggle to capture fully."
        ];

        let currentText = '';
        let fullText = '';
        let currentIndex = 0;
        let startTime = null;
        let timerInterval = null;
        let timeRemaining = 60;
        let selectedTime = 60;
        let wpmData = [];
        let timeData = [];
        let correctChars = 0;
        let incorrectChars = 0;
        let isTestActive = false;

        const textDisplay = document.getElementById('textDisplay');
        const textScroll = document.getElementById('textScroll');
        const inputArea = document.getElementById('inputArea');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const timeSelect = document.getElementById('timeSelect');
        const wpmElement = document.getElementById('wpm');
        const accuracyElement = document.getElementById('accuracy');
        const timerElement = document.getElementById('timer');
        const errorsElement = document.getElementById('errors');
        const resultsDiv = document.getElementById('results');

        let chart = null;

        function initChart() {
            const ctx = document.getElementById('wpmChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'WPM',
                        data: [],
                        borderColor: '#e2b714',
                        backgroundColor: 'rgba(226, 183, 20, 0.1)',
                        tension: 0.4,
                        fill: true,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#e2b714',
                        pointBorderColor: '#e2b714'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                color: '#e2b714',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Words Per Minute Over Time',
                            font: { size: 16 },
                            color: '#e2b714'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'WPM',
                                color: '#e2b714'
                            },
                            ticks: {
                                color: '#646669'
                            },
                            grid: {
                                color: '#3d3f43'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Time (seconds)',
                                color: '#e2b714'
                            },
                            ticks: {
                                color: '#646669'
                            },
                            grid: {
                                color: '#3d3f43'
                            }
                        }
                    }
                }
            });
        }

        function displayText() {
            const shuffled = [...texts].sort(() => Math.random() - 0.5);
            const numParagraphs = Math.floor(Math.random() * 3) + 3;
            fullText = shuffled.slice(0, numParagraphs).join(' ');
            currentText = fullText;
            
            textScroll.innerHTML = currentText.split('').map((char, index) => 
                `<span id="char-${index}">${char}</span>`
            ).join('');
        }

        function startTest() {
            isTestActive = true;
            startTime = Date.now();
            selectedTime = parseInt(timeSelect.value);
            timeRemaining = selectedTime;
            currentIndex = 0;
            correctChars = 0;
            incorrectChars = 0;
            wpmData = [];
            timeData = [];
            
            inputArea.value = '';
            inputArea.disabled = false;
            inputArea.focus();
            startBtn.disabled = true;
            timeSelect.disabled = true;
            resultsDiv.classList.remove('show');
            
            displayText();
            updateCurrentChar();
            
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            timeRemaining--;
            timerElement.textContent = `${timeRemaining}s`;
            
            if (timeRemaining <= 0) {
                endTest();
            } else {
                updateWPMChart();
            }
        }

        function updateCurrentChar() {
            document.querySelectorAll('.text-display span').forEach(span => {
                span.classList.remove('current');
            });
            
            if (currentIndex < currentText.length) {
                const currentCharElement = document.getElementById(`char-${currentIndex}`);
                currentCharElement.classList.add('current');
                
                const charRect = currentCharElement.getBoundingClientRect();
                const displayRect = textDisplay.getBoundingClientRect();
                const scrollContainer = textScroll;
                
                const charTop = currentCharElement.offsetTop;
                const displayHeight = textDisplay.clientHeight;
                const centerPosition = displayHeight / 2;
                
                if (charTop > centerPosition) {
                    const scrollAmount = charTop - centerPosition;
                    scrollContainer.style.transform = `translateY(-${scrollAmount}px)`;
                }
            }
        }

        function calculateWPM() {
            if (!startTime) return 0;
            const timeElapsed = (Date.now() - startTime) / 1000 / 60;
            const words = correctChars / 5;
            return Math.round(words / timeElapsed);
        }

        function calculateAccuracy() {
            const total = correctChars + incorrectChars;
            if (total === 0) return 100;
            return Math.round((correctChars / total) * 100);
        }

        function updateWPMChart() {
            const elapsed = selectedTime - timeRemaining;
            const currentWPM = calculateWPM();
            
            wpmData.push(currentWPM);
            timeData.push(elapsed);
            
            chart.data.labels = timeData;
            chart.data.datasets[0].data = wpmData;
            chart.update();
        }

        function endTest() {
            isTestActive = false;
            clearInterval(timerInterval);
            inputArea.disabled = true;
            startBtn.disabled = false;
            timeSelect.disabled = false;
            
            const finalWpm = calculateWPM();
            const finalAccuracy = calculateAccuracy();
            
            document.getElementById('finalWpm').textContent = finalWpm;
            document.getElementById('finalAccuracy').textContent = `${finalAccuracy}%`;
            document.getElementById('finalChars').textContent = correctChars + incorrectChars;
            document.getElementById('finalErrors').textContent = incorrectChars;
            
            resultsDiv.classList.add('show');
        }

        function resetTest() {
            isTestActive = false;
            clearInterval(timerInterval);
            
            currentIndex = 0;
            correctChars = 0;
            incorrectChars = 0;
            selectedTime = parseInt(timeSelect.value);
            timeRemaining = selectedTime;
            startTime = null;
            wpmData = [];
            timeData = [];
            
            inputArea.value = '';
            inputArea.disabled = true;
            startBtn.disabled = false;
            timeSelect.disabled = false;
            
            wpmElement.textContent = '0';
            accuracyElement.textContent = '100%';
            timerElement.textContent = `${selectedTime}s`;
            errorsElement.textContent = '0';
            
            resultsDiv.classList.remove('show');
            
            chart.data.labels = [];
            chart.data.datasets[0].data = [];
            chart.update();
            
            textScroll.style.transform = 'translateY(0)';
            
            displayText();
        }

        inputArea.addEventListener('input', (e) => {
            if (!isTestActive) return;
            
            const typed = e.target.value;
            const currentChar = currentText[currentIndex];
            
            if (typed.endsWith(currentChar)) {
                document.getElementById(`char-${currentIndex}`).classList.add('correct');
                document.getElementById(`char-${currentIndex}`).classList.remove('incorrect');
                correctChars++;
                currentIndex++;
                e.target.value = '';
                
                if (currentIndex >= currentText.length) {
                    endTest();
                    return;
                }
                
                updateCurrentChar();
            } else if (typed.length > 0) {
                document.getElementById(`char-${currentIndex}`).classList.add('incorrect');
                incorrectChars++;
                e.target.value = '';
            }
            
            wpmElement.textContent = calculateWPM();
            accuracyElement.textContent = `${calculateAccuracy()}%`;
            errorsElement.textContent = incorrectChars;
        });

        timeSelect.addEventListener('change', () => {
            if (!isTestActive) {
                selectedTime = parseInt(timeSelect.value);
                timeRemaining = selectedTime;
                timerElement.textContent = `${selectedTime}s`;
            }
        });

        startBtn.addEventListener('click', startTest);
        resetBtn.addEventListener('click', resetTest);

        initChart();
        displayText();
    </script>
</body>
</html>
